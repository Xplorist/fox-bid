(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a9d4cf9"],{"153f":function(t,e,i){t.exports=i.p+"img/winImg.cba78bee.png"},1701:function(t,e,i){"use strict";var s=i("d80b"),n=i.n(s);n.a},"1ca6":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAAk0lEQVQYV2NMyqufysDIkMWAH0xjDA0NZeaV1NrBwMjgglXtf4Y99y4xejKCJBMKGgSY/jOcYGD4r46i+D/DrX9MjOYLJjR8ACsEgbjsejUW5v8nGBgZBcEC//+/Z/7LaDF7auMtEBeuEMRJzqtz/s/IuAOs8N9fz3mTW/bADEJRCBJMLKjLZPrPxDh3YsM0ZGcAAGFyKfDeCywQAAAAAElFTkSuQmCC"},"2c4b":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"choose-details"},[s("div",{staticClass:"top"},[s("div",{staticClass:"back-btn"},[s("router-link",{attrs:{to:"/demand"}},[t._v("\n        返回\n      ")])],1),s("div",{staticClass:"sort",staticStyle:{position:"relative"}},[s("div",{staticClass:"sort-btn",on:{click:function(e){t.sortFlag=!t.sortFlag}}},[s("span",[t._v("排序：")]),s("span",[t._v(t._s(t._f("sortNameFormat")(t.sortBy)))]),s("img",{attrs:{src:i("1ca6"),alt:""}})]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.sortFlag,expression:"sortFlag"}],staticClass:"classify-list"},t._l(t.classifyList,(function(e){return s("span",{key:e.id,class:{active:t.sortBy==e.val},on:{click:function(i){return t.selectClassfiy(e.val)}}},[t._v(t._s(e.name))])})),0),t.toEndTimeFlag&&"1"===t.billInfo.bill_status?s("button",{staticClass:"fail-btn",on:{click:t.faliBid}},[t._v("\n        棄標\n      ")]):t._e()])]),t.billInfo?s("div",{staticClass:"title"},[s("div",{staticClass:"tit-text"},[t._v("\n      【模具】需求單號"+t._s(t.billInfo.bill_no)+" 需求量:"+t._s(t.billInfo.amount)+"\n      "),s("router-link",{staticClass:"title_btn",attrs:{to:"/particulars?pkid="+t.pkid}},[t._v("\n        詳情\n      ")])],1),s("div",{staticClass:"tit-info"},[t._v("\n      我的報價: "+t._s(t.billInfo.total_price)+" "+t._s(t.billInfo.money_type)+"\n    ")]),s("div",{staticClass:"tit-info"},[t._v("發佈時間: "+t._s(t.billInfo.publish_date))]),s("div",{staticClass:"tit-unit"},[t._v("\n      當前項目投標單位數\n      "),s("span",[t._v("\n        "+t._s(t.billInfo.give_recv_user_list?t.billInfo.give_recv_user_list.length:0)+"\n      ")])])]):t._e(),t.give_price_list?s("table",{staticStyle:{width:"100%","text-align":"center","border-collapse":"collapse"}},[s("tr",t._l(t.tableTitleContrast,(function(e,i){return s("th",{key:i+e,style:{minWidth:e.minWidth}},[t._v("\n        "+t._s(e.name)+"\n      ")])})),0),t._l(t.give_price_list,(function(e,n){return s("tr",{key:e.pkid},[s("td",[t._v(t._s(n+1+(t.currentPage-1)*t.pageSize))]),s("td",[s("router-link",{staticStyle:{color:"#0096ff"},attrs:{to:"/merchant/information?pkid="+e.recv_user.pkid}},[t._v("\n          "+t._s(e.recv_user.dept_name)+"\n        ")])],1),s("td",[t._v(t._s(e.total_price*t.billInfo.amount))]),s("td",[s("div",{staticClass:"detail-list"},[s("span",[t._v(t._s(e.total_price))]),s("div",{staticClass:"show-list",on:{click:function(i){return t.getSlavList(e)}}},[t._v("\n            標書\n          ")])])]),s("td",[t._v(t._s(e.deliver_date.split(" ")[0]))]),s("td",[t._v(t._s(e.descp))]),"1"===t.billInfo.bill_status&&"Y"===e.f_valid?s("td",{class:t.toEndTimeFlag?"choose-win":"choose-win-disabled",on:{click:function(i){return t.chooseToWin(e.pkid,e.recv_user.dept_name,e.f_valid)}}},[t._v("\n        选为中标\n      ")]):"1"===t.billInfo.bill_status&&"N"===e.f_valid?s("td",[t._v("\n        報價過高\n      ")]):s("td",["Y"===e.f_win_bid?s("img",{attrs:{src:i("153f"),alt:""}}):t._e()])])})),0==t.give_price_list.length?s("tr",[s("td",{attrs:{colspan:"7"}},[t._v("暫無數據")])]):t._e()],2):t._e(),s("Paging",{attrs:{total:t.total,"current-page":t.currentPage,"page-size":t.pageSize},on:{getCurrentPage:t.getListDate}})],1)},n=[],a=(i("c5f6"),i("ac4d"),i("8a81"),i("ac6a"),i("def5")),r=i("f8b7"),l=[{minWidth:"40px",name:"排名"},{minWidth:"160px",name:"單位"},{minWidth:"60px",name:"總報價"},{minWidth:"180px",name:"廠商報價"},{minWidth:"100px",name:"交期"},{minWidth:"140px",name:"備註"},{minWidth:"140px",name:"操作"}],o={data:function(){return{toEndTimeFlag:!1,sortItem:"",total:1,currentPage:1,pageSize:8,pkid:"",give_price_list:[],billInfo:{},slav_list:[],classifyList:[{id:1,name:"綜合排序",val:"complex"},{id:2,name:"價格優先",val:"price"},{id:3,name:"交期優先",val:"date"}],sortBy:"complex",sortFlag:!1,recvPkid:"",tableTitleContrast:l}},methods:{faliBid:function(){var t=this;this.$confirm("此操作將“廢棄”此訂單，是否繼續？","警告",{confirmButtonText:"確認",cancelButtonText:"取消",type:"error"}).then((function(){var e=t.billInfo.pkid;Object(r["a"])(e).then((function(e){"1"===e.code?(t.$router.push("/demand"),t.$message({type:"success",message:"已棄標"})):t.$message.error(e.msg)}))})).catch((function(){t.$message({type:"info",message:"已取消"})}))},checkList:function(){sessionStorage.setItem("biddinfdDoc",JSON.stringify(this.billInfo)),sessionStorage.setItem("recvPkid",JSON.stringify(this.recvPkid));var t=this.$router.resolve({path:"/biddingDoc",query:{loaded:!0,pkid:this.pkid}});window.open(t.href,"_blank")},selectClassfiy:function(t){this.sortBy=t,this.sortFlag=!1},getSlavList:function(t){var e=t.pkid;this.recvPkid=t.recv_user_pkid,sessionStorage.setItem("deliverDate",JSON.stringify(t.deliver_date));var i=!0,s=!1,n=void 0;try{for(var a,r=this.give_price_list[Symbol.iterator]();!(i=(a=r.next()).done);i=!0){var l=a.value;l.pkid==e&&(sessionStorage.setItem("slavList",JSON.stringify(l.slav_list)),this.checkList())}}catch(o){s=!0,n=o}finally{try{i||null==r.return||r.return()}finally{if(s)throw n}}},getTimeStatus:function(){var t=new Date(this.billInfo.bid_end_date),e=new Date;this.toEndTimeFlag=e>t},chooseToWin:function(t,e){var i=this;if(!this.toEndTimeFlag)return this.$alert("競標結束時間未到，不能選標！","警告",{confirmButtonText:"确定",callback:function(t){return t}});this.$confirm('请确认是否将 "'+e+'" 选为中标单位?',"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then((function(){Object(r["v"])(t).then((function(t){"1"===t.code?(i.getBillInfo(),i.getListDate(Number(sessionStorage.getItem("demandDetailsCurrentPage"))),i.$message({type:"success",message:"成功!"})):i.$message.error(t.msg)}))})).catch((function(){i.$message({type:"info",message:"已取消"})}))},getListDate:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.currentPage=Number(e),sessionStorage.setItem("demandDetailsCurrentPage",this.currentPage);var i={bill_pkid:this.pkid,pageIndex:this.currentPage,pageSize:this.pageSize,sort_way:this.sortBy};Object(r["i"])(i).then((function(e){if("1"===e.code){t.give_price_list=[],t.total=e.t.row_total;var i=e.t.give_price_list;t.changeListData(i)}else t.$message.error(e.msg)}))},changeListData:function(t){var e=!0,i=!1,s=void 0;try{for(var n,a=t[Symbol.iterator]();!(e=(n=a.next()).done);e=!0){var r=n.value;this.give_price_list.push(r)}}catch(l){i=!0,s=l}finally{try{e||null==a.return||a.return()}finally{if(i)throw s}}},getBillInfo:function(){var t=this;Object(r["c"])(this.pkid).then((function(e){"1"===e.code?(t.billInfo=e.t,t.getTimeStatus()):t.$message.error(e.msg)}))}},components:{Paging:a["a"]},created:function(){this.pkid=this.$router.history.current.query.pkid;var t=Number(sessionStorage.getItem("demandDetailsCurrentPage"));t=t||1,this.getListDate(t),this.getBillInfo()},filters:{sortNameFormat:function(t){if(!t)return"";switch(t){case"complex":return"綜合排序";case"price":return"價格優先";case"date":return"時間優先"}}},watch:{sortBy:function(){this.getListDate()}},computed:{}},c=o,d=(i("1701"),i("2877")),u=Object(d["a"])(c,s,n,!1,null,"4a04de47",null);e["default"]=u.exports},d80b:function(t,e,i){}}]);
//# sourceMappingURL=chunk-6a9d4cf9.5f32de6b.js.map