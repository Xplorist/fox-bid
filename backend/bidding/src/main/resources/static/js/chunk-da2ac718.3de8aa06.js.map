{"version":3,"sources":["webpack:///./src/views/demand/Evaluation.vue?cced","webpack:///./src/views/demand/Evaluation.vue?b707","webpack:///src/views/demand/Evaluation.vue","webpack:///./src/views/demand/Evaluation.vue?f408","webpack:///./src/views/demand/Evaluation.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","class","active","commentsType","on","$event","_s","receivedNum","publishedNum","directives","name","rawName","value","expression","_l","rate","item","index","key","attrs","color","model","callback","$$v","$set","text","date","belong","total","currentPage","pageSize","getListDate","staticRenderFns","data","list","comments","allReceivedComments","allPublishedComments","silderBarItem","methods","handlePage","val","start","end","slice","getPage","type","length","Number","page","sessionStorage","setItem","_query_send_get_eval_list","_query_send_make_eval_list","res","code","changeListData","getRate","t","created","components","Paging","watch","component"],"mappings":"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","file":"js/chunk-da2ac718.3de8aa06.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Evaluation.vue?vue&type=style&index=0&id=25db5cfe&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Evaluation.vue?vue&type=style&index=0&id=25db5cfe&lang=less&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"evaluation\"},[_c('div',{staticClass:\"mainPart\"},[_c('div',{staticClass:\"main-title\"},[_vm._v(\"評價管理\")]),_c('div',{staticClass:\"main-classify\"},[_c('div',{class:{active:_vm.commentsType == 'received'},on:{\"click\":function($event){_vm.commentsType = 'received'}}},[_vm._v(\"收到的評價(\"+_vm._s(_vm.receivedNum || 0)+\")\")]),_c('div',{class:{active:_vm.commentsType == 'published'},on:{\"click\":function($event){_vm.commentsType = 'published'}}},[_vm._v(\"做出的評價(\"+_vm._s(_vm.publishedNum || 0)+\")\")])]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.commentsType !== 'published'),expression:\"commentsType !== 'published'\"}],staticClass:\"main-rate\"},_vm._l((_vm.rate.list),function(item,index){return _c('div',{key:index,staticClass:\"single\"},[_c('span',[_vm._v(_vm._s(item.name)+\":\")]),_c('el-rate',{staticClass:\"stars\",attrs:{\"disabled\":\"\",\"show-score\":\"\",\"text-color\":\"#0096FF\",\"score-template\":\"{value}\",\"disabled-void-color\":\"#D3DFE7\",\"colors\":_vm.rate.color},model:{value:(item.value),callback:function ($$v) {_vm.$set(item, \"value\", $$v)},expression:\"item.value\"}})],1)}),0),_c('div',{staticClass:\"main-evaluation-box\"},_vm._l((_vm.comments),function(item,index){return _c('div',{key:index,staticClass:\"single\"},[_c('div',[_c('div',{staticClass:\"comments\"},[_vm._v(_vm._s(item.text))]),_c('div',{staticClass:\"date\"},[_vm._v(_vm._s(item.date))])]),_c('div',{staticClass:\"belong\"},[_vm._v(_vm._s(item.belong))])])}),0),_c('div',{staticClass:\"main-paging\"},[_c('Paging',{attrs:{\"total\":_vm.total,\"current-page\":_vm.currentPage,\"page-size\":_vm.pageSize},on:{\"getCurrentPage\":_vm.getListDate}})],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"evaluation\">\r\n    <div class=\"mainPart\">\r\n      <!-- title -->\r\n      <div class=\"main-title\">評價管理</div>\r\n      <!-- 分類 -->\r\n      <div class=\"main-classify\">\r\n        <div\r\n          :class=\"{active:commentsType == 'received'}\"\r\n          @click=\"commentsType = 'received'\"\r\n        >收到的評價({{ receivedNum || 0 }})</div>\r\n        <div\r\n          :class=\"{active:commentsType == 'published'}\"\r\n          @click=\"commentsType = 'published'\"\r\n        >做出的評價({{ publishedNum || 0 }})</div>\r\n      </div>\r\n      <!-- 評分 -->\r\n      <div class=\"main-rate\" v-show=\"commentsType !== 'published'\">\r\n        <div class=\"single\" v-for=\"(item, index) in rate.list\" :key=\"index\">\r\n          <span>{{item.name}}:</span>\r\n          <el-rate\r\n            disabled\r\n            show-score\r\n            class=\"stars\"\r\n            text-color=\"#0096FF\"\r\n            score-template=\"{value}\"\r\n            disabled-void-color=\"#D3DFE7\"\r\n            :colors=\"rate.color\"\r\n            v-model=\"item.value\"\r\n          ></el-rate>\r\n        </div>\r\n      </div>\r\n      <!-- 評價 -->\r\n      <div class=\"main-evaluation-box\">\r\n        <!-- 單獨評語 -->\r\n        <div class=\"single\" v-for=\"(item, index) in comments\" :key=\"index\">\r\n          <div>\r\n            <div class=\"comments\">{{item.text}}</div>\r\n            <div class=\"date\">{{item.date}}</div>\r\n          </div>\r\n          <div class=\"belong\">{{item.belong}}</div>\r\n        </div>\r\n      </div>\r\n      <!-- 分頁 -->\r\n      <div class=\"main-paging\">\r\n        <Paging\r\n          :total=\"total\"\r\n          :current-page=\"currentPage\"\r\n          :page-size=\"pageSize\"\r\n          @getCurrentPage=\"getListDate\"\r\n        ></Paging>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Paging from \"@/components/paging/Paging\";\r\nimport {\r\n  query_send_get_eval_list,\r\n  query_send_make_eval_list,\r\n  query_send_get_eval_avg\r\n} from \"@/api/order\";\r\n\r\nexport default {\r\n  data: function() {\r\n    return {\r\n      // 評分信息\r\n      rate: {\r\n        // 評分顏色\r\n        color: [\"#0096FF\", \"#0096FF\", \"#0096FF\"],\r\n        // 評分類型、值、數量\r\n        list: [{ name: \"付款時效\", value: 0 }, { name: \"服務態度\", value: 0 }]\r\n      },\r\n      // 总页数\r\n      total: null,\r\n      // 当前页\r\n      currentPage: null,\r\n      // 每页数目\r\n      pageSize: 6,\r\n      // 展现的评价\r\n      comments: [],\r\n      // 收到的評價\r\n      allReceivedComments: [],\r\n      // 做出的评价\r\n      allPublishedComments: [],\r\n      // 选中的侧边栏条目\r\n      silderBarItem: \"evaluation\",\r\n      // 評價類型\r\n      commentsType: \"\",\r\n      // 評價個數\r\n      receivedNum: null,\r\n      publishedNum: null\r\n    };\r\n  },\r\n  methods: {\r\n    // 处理分页\r\n    handlePage(val) {\r\n      this.currentPage = val;\r\n      var start = (this.currentPage - 1) * this.pageSize;\r\n      var end = start + this.pageSize;\r\n      if (this.commentsType == \"published\") {\r\n        this.comments = this.allPublishedComments.slice(start, end);\r\n      } else {\r\n        this.comments = this.allReceivedComments.slice(start, end);\r\n      }\r\n    },\r\n\r\n    // 获取总数目\r\n    getPage(type) {\r\n      this.commentsType = type || \"received\";\r\n      switch (this.commentsType) {\r\n        case \"published\":\r\n          this.total = this.allPublishedComments.length;\r\n          break;\r\n        default:\r\n          this.total = this.allReceivedComments.length;\r\n          break;\r\n      }\r\n      this.handlePage(1);\r\n    },\r\n\r\n    // 向後端發起請求獲取數據\r\n    getListDate(page = 1) {\r\n      this.currentPage = Number(page);\r\n      sessionStorage.setItem(\"demandGetEvaCurrentPage\", this.currentPage);\r\n      if (this.commentsType == \"received\") {\r\n        this._query_send_get_eval_list();\r\n      } else if (this.commentsType == \"published\") {\r\n        this._query_send_make_eval_list();\r\n      } else {\r\n        this._query_send_get_eval_list();\r\n        this.commentsType = \"received\";\r\n        query_send_make_eval_list(this.currentPage, this.pageSize).then(res => {\r\n          if (res.code === \"1\") {\r\n            this.publishedNum = res.t.row_total;\r\n          } else {\r\n            this.$message.error(res.msg);\r\n          }\r\n        });\r\n      }\r\n    },\r\n\r\n    // received\r\n    _query_send_get_eval_list() {\r\n      query_send_get_eval_list(this.currentPage, this.pageSize).then(res => {\r\n        if (res.code === \"1\") {\r\n          // 清空原有數據\r\n          this.comments = [];\r\n          this.total = res.t.row_total;\r\n          this.receivedNum = res.t.row_total;\r\n          const listData = res.t.send_get_eval_list;\r\n          this.changeListData(listData);\r\n        } else {\r\n          this.$message.error(res.msg);\r\n        }\r\n      });\r\n    },\r\n    // published\r\n    _query_send_make_eval_list() {\r\n      query_send_make_eval_list(this.currentPage, this.pageSize).then(res => {\r\n        if (res.code === \"1\") {\r\n          // 清空原有數據\r\n          this.comments = [];\r\n          this.total = res.t.row_total;\r\n          this.publishedNum = res.t.row_total;\r\n          const listData = res.t.send_make_eval_list;\r\n          this.changeListData(listData);\r\n        } else {\r\n          this.$message.error(res.msg);\r\n        }\r\n      });\r\n    },\r\n\r\n    // 修改數據格式\r\n    changeListData(listData) {\r\n      for (let item of listData) {\r\n        const obj = {\r\n          text: item.summary_text,\r\n          date: item.create_date,\r\n          belong: item.recv_user ? item.recv_user.dept_name : \"此賬號已註銷\"\r\n        };\r\n        this.comments.push(obj);\r\n      }\r\n    },\r\n\r\n    // 獲取評分\r\n    getRate() {\r\n      query_send_get_eval_avg().then(res => {\r\n        if (res.code === \"1\") {\r\n          if (!res.t) return;\r\n          this.rate.list[0].value = Number(res.t.pay_rate_avg);\r\n          this.rate.list[1].value = Number(res.t.svc_atitu_avg);\r\n        } else {\r\n          this.$message.error(res.msg);\r\n        }\r\n      });\r\n    }\r\n  },\r\n  created() {\r\n    // 獲取分頁數據\r\n    let page = Number(sessionStorage.getItem(\"demandGetEvaCurrentPage\"));\r\n    page = page ? page : 1;\r\n    this.getListDate(page);\r\n    // 獲取評分\r\n    this.getRate();\r\n  },\r\n  components: {\r\n    Paging\r\n  },\r\n  watch: {\r\n    commentsType: function() {\r\n      this.getListDate();\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.evaluation {\r\n  background-color: #eff9ff;\r\n  box-sizing: border-box;\r\n  color: #12222e;\r\n  padding: 30px 100px;\r\n}\r\n// 主體標題\r\n.main-title {\r\n  color: #12222e;\r\n  font-size: 18px;\r\n  padding-bottom: 20px;\r\n  margin-bottom: 20px;\r\n  border-bottom: 1px solid #afc2cf;\r\n}\r\n// 分類\r\n.main-classify {\r\n  display: flex;\r\n  align-items: center;\r\n  cursor: pointer;\r\n  user-select: none;\r\n  div {\r\n    width: 200px;\r\n    height: 36px;\r\n    line-height: 36px;\r\n    text-align: center;\r\n    background-color: #c8d4de;\r\n    color: #212f3a;\r\n    transition-duration: 0.2s;\r\n    &.active,\r\n    &:hover {\r\n      background-color: #2e6e9e;\r\n      color: #d3dfe7;\r\n    }\r\n  }\r\n}\r\n// 評分\r\n.main-rate {\r\n  margin-top: 16px;\r\n  user-select: none;\r\n  > .single {\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n  .stars {\r\n    margin: 5px;\r\n    width: 160px;\r\n  }\r\n}\r\n// 評價\r\n.main-evaluation-box {\r\n  margin-top: 20px;\r\n  > .single {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    border-top: 1px solid #afc2cf;\r\n    padding: 20px 0;\r\n    position: relative;\r\n  }\r\n  .comments {\r\n    color: #212f3a;\r\n  }\r\n  .date {\r\n    color: #626f7f;\r\n    font-size: 14px;\r\n    margin-top: 15px;\r\n  }\r\n  .belong {\r\n    color: #626f7f;\r\n    font-size: 14px;\r\n    position: absolute;\r\n    right: 0;\r\n    bottom: 20px;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Evaluation.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Evaluation.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Evaluation.vue?vue&type=template&id=25db5cfe&scoped=true&\"\nimport script from \"./Evaluation.vue?vue&type=script&lang=js&\"\nexport * from \"./Evaluation.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Evaluation.vue?vue&type=style&index=0&id=25db5cfe&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"25db5cfe\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}